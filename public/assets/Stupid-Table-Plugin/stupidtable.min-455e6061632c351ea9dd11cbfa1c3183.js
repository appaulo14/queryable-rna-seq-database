(function(e){e.fn.stupidtable=function(t){return this.each(function(){var n=e(this);t=t||{},t=e.extend({},{"int":function(e,t){return parseInt(e,10)-parseInt(t,10)},"float":function(e,t){return parseFloat(e)-parseFloat(t)},string:function(e,t){return e<t?-1:e>t?1:0}},t),n.on("click","th",function(){var r=n.children("tbody").children("tr"),i=e(this),s=0;n.find("th").slice(0,i.index()).each(function(){var t=e(this).attr("colspan")||1;s+=parseInt(t)});var o=i.data("sort")||null;if(o){var u=t[o],a=[];r.each(function(t,n){var r=e(n).children().eq(s),r=r.data("sort-value")||r.text();a.push(r)});var o=[],l=a.slice(0),c=a.slice(0).reverse(),h=a.slice(0).sort(u);if((l&&h&&!(l<h||h<l)||c&&h&&!(c<h||h<c))&&null!==i.data("sort-dir")){a.reverse();for(u=a.length-1;0<=u;u--)o.push(u)}else{o=a.slice(0).sort(u),u=[];for(c=l=0;c<a.length;c++){for(l=e.inArray(a[c],o);-1!=e.inArray(l,u);)l++;u.push(l)}o=u}u="asc"===i.data("sort-dir")?"desc":"asc",i.siblings("th").data("sort-dir",null),i.data("sort-dir",u),i=o,o=r.slice(0);for(l=0;l<i.length;l++)newIndex=i[l],o[newIndex]=r[l];r=e(o),n.children("tbody").append(r),n.trigger("aftertablesort",{column:s,direction:u})}})})}})(jQuery);