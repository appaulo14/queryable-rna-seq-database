<%= render 'shared/error_messages', :object => @query_using_tblastx %>
<script type='text/javascript' src='query_using_tblastx.js'></script>
<%= form_for(@query_using_tblastx,{:url => "query_using_tblastx"}) do |bq| %>
  <h2>
    Choose Data Set to Search Using TBlastx
    <%= image_tag('question_mark.png', :id=>'tblastx_qtip')%>
  </h2>
  <p>
      <%= bq.label(:dataset_id, "Dataset:") %>
      <%= bq.select(:dataset_id, options_for_select(bq.object.available_datasets,bq.object.dataset_id)) %>
      <%= image_tag('question_mark.png', :id=>'dataset_id_qtip') %>
  </p>
  <hr/>
  <h2>Enter a Query Sequence</h2>
<!--Enter or upload fasta sequence-->
    <p>
      <div>
        <%= bq.radio_button(:use_fasta_sequence_or_file, :use_fasta_sequence) %>
        <%= bq.label :fasta_sequence, 
          raw('Enter <em>nucleic acid</em> sequence(s) below in FASTA format') %>
        <%= image_tag('question_mark.png', :id=>'fasta_sequence_qtip')%><br/>
        <%= bq.text_area :fasta_sequence, {:cols=>80, :rows => 6} %><br/>
      </div>
      <div>
        <%= bq.radio_button(:use_fasta_sequence_or_file, :use_fasta_file) %>
        <%= bq.label :fasta_file, "Or load it from disk" %><br/>
        <%= bq.file_field :fasta_file %><br/>
      </div>
    </p>
    <hr/>
  <h2>Algorithm settings</h2>
  
  <div class='sub-section rounded-corners' style='padding:5px'>
    <p class='sub-section-heading-2'>General Parameters</p>
    <div>
        <%= bq.label :num_alignments, "Number of alignments to show" %>
        <%= bq.select :num_alignments, options_for_select(bq.object.available_num_alignments,
            bq.object.num_alignments) %>
        <%= image_tag('question_mark.png', :id=>'num_alignments_qtip')%>
    </div>
    <p>
        <%= bq.label :e_value, "Expect threshold (e-value)" %>
        <%= bq.text_field :e_value, :size => 10 %>
        <%= image_tag('question_mark.png', :id=>'evalue_qtip')%>
    </p>
    <div>
        <%= bq.label :word_size, "Word size" %>
        <%= select_tag(:word_size, 
          options_for_select(bq.object.available_word_sizes,bq.object.word_size)) %>
        <%= image_tag('question_mark.png', :id=>'word_size_qtip')%>
    </div>
    <div>
      <%= bq.label :genetic_code, "Genetic Code" %>
      <%= bq.select :genetic_code, options_for_select(bq.object.available_genetic_codes,bq.object.genetic_code) %>
      <%= image_tag('question_mark.png', :id=>'genetic_code_qtip')%>
    </div>
  </div>
  <br/>
  <div class='sub-section rounded-corners' style='padding:5px'>
    <p class='sub-section-heading-2'>Scoring Parameters</p>
      <%= bq.label :matrix, "Matrix" %>
      <%= bq.select :matrix, options_for_select(bq.object.available_matrices,
            bq.object.matrix) %>
      <%= image_tag('question_mark.png', :id => 'matrix_qtip') %>
  </div>
  <br/>
  <div class='sub-section rounded-corners' style='padding:5px'>
    <p class='sub-section-heading-2'>Filters and Masking</p>
    <p>
        <%= bq.check_box :filter_low_complexity_regions %><%= bq.label :filter_low_complexity_regions, "Filter low complexity regions" %>
        <%= image_tag('question_mark.png', :id=>'filter_low_complexity_regions_qtip')%><br/>
        <%= bq.check_box :use_soft_masking %> <%= bq.label :use_soft_masking, "Mask for lookup table only" %>
        <%= image_tag('question_mark.png', :id=>'use_soft_masking_qtip')%><br/>
        <%= bq.check_box :use_lowercase_masking %> <%= bq.label :use_lowercase_masking, "Mask lowercase letters" %>
        <%= image_tag('question_mark.png', :id=>'use_lowercase_masking_qtip')%><br/>
    </p>
  </div>
    <p><%= button_tag 'Reset', :type => 'reset' %> <%= submit_tag("BLAST", :disable_with => "BLASTing...") %></p>
<% end %>

<br/>
<div>
  <div class='sub-section-heading-2'>References</div>
  <ol>
    <li id="reference_1">
      National Center for Biotechnology Information, "Translated BLAST: tblastx", Jan. 2013;<br/>
      <% href = 'http://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=tblastx' +
                '&BLAST_PROGRAMS=tblastx&PAGE_TYPE=BlastSearch' +
                '&SHOW_DEFAULTS=on&LINK_LOC=blasthome' %>
      <a target="_blank" href="<%= href %>">
        http://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=tblastx&BLAST_PROGRAMS=tblastx&<br/>
        PAGE_TYPE=BlastSearch&SHOW_DEFAULTS=on&LINK_LOC=blasthome</a>.
    </li>
    <li id="reference_2">
    BLASTÂ® Help [Internet]. Bethesda (MD): National Center for Biotechnology Information (US);</br>
    2008-. Table C6: tblastx application options... Available from: <br/>
    <% href = 'http://www.ncbi.nlm.nih.gov/books/NBK1763/table/CmdLineAppsManual.T.tblastx_application_/' %>
    <a target="_blank" href="<%= href %>"><%= href %></a>
    </li>
  </ol>
</div>
